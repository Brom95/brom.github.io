<!DOCTYPE html>
<html lang="ru-ru"><head>
    <title>Гри-Гри для JWT</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="" />
    <style>
@import "https://fonts.googleapis.com/css2?family=Inconsolata&display=swap";:root{--cursor-visibility:hidden}html,body{width:100%;height:100%;overflow:auto;font-family:inconsolata,monospace;font-size:4vmin;line-height:4.1vmin;font-weight:400}body{margin:0;display:flex;flex-direction:row;justify-content:center;align-items:center}#content{min-width:82vmin;min-height:82vmin}::-webkit-scrollbar{width:10px}::-webkit-scrollbar-track{border-radius:10px;box-shadow:inset 0 0 1px white}::-webkit-scrollbar-thumb{border-radius:10px;box-shadow:0 0 0 1px white}.cursor,#activity-title:after,#activity-content:after,#cd:after,#whoami:after,#cat:after,#tree:after{visibility:var(--cursor-visibility);content:"|";overflow:hidden;color:#fff;animation:blink 500ms linear infinite alternate}@keyframes blink{0%{opacity:0}100%{opacity:1}}@media only screen and (min-width:768px){body{font-size:2.5vmin;line-height:2.6vmin}#content{min-width:60vmin}}:root{--cursor-visibility:hidden}body{align-items:unset;overflow-y:scroll}#content{max-width:80vmin}pre{overflow-x:scroll;white-space:pre}@keyframes blink{0%{opacity:0}100%{opacity:1}}















    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
        
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    



body{background:#1b1d1e}body #terminal{color:#BBBBBB}body #user{color:#23E298}body #dir{color:#D08010}body .Typewriter__cursor{color:#BBBBBB}a{color:#BBBBBB}

        
.navFull {
    background-color: #353535;
    font-family: "Courier New";
    font-size: 17px;
    display: inline;
    position: fixed;
    bottom: 0px;
    left: 0px;
    width: 100%;
    padding-top: 5px;
    padding: 10px;
    padding-bottom: 0px;
}

.navCredits {
    float: right;
    padding-right: 18px;
    padding-bottom: 10px;
    padding-top: 5px;
}

#content::after {
    content: "\a\a";
    white-space: pre;
}
        
        
</style>



    <meta name="yandex-verification" content="355904de153d5134" />
    

<script>window.yaContextCb=window.yaContextCb||[]</script>
<script src="https://yandex.ru/ads/system/context.js" async></script>

<script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();
    for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
    k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
 
    ym(90533415, "init", {
         clickmap:true,
         trackLinks:true,
         accurateTrackBounce:true
    });
 </script>
 <noscript><div><img src="https://mc.yandex.ru/watch/90533415" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
 


</head><body><div id="content">
<div id="block">

    <div id="yandex_rtb_R-A-1957258-2"></div>
    <script>window.yaContextCb.push(() => {
            Ya.Context.AdvManager.render({
                renderTo: 'yandex_rtb_R-A-1957258-2',
                blockId: 'R-A-1957258-2'
            })
        })</script>
</div>
    
    
    



    


    <span id="activity-title"></span> <br>
 <span id="activity-content"></span> <br>

<script type="text/javascript">
    async function typewriter(text, elementId, waitAfter) {
        var n = 0,
            isTag = false
        addText = "";
        const el = document.getElementById(elementId);

        const wait = () => new Promise(r => setTimeout(r, waitAfter));
        const nowait = () => new Promise(r => r());

        const render = () => el.innerHTML = (text.slice(0, n + 1) + addText);

        const cursor = document.createElement('span');
        cursor.id = "blink";

        el.style.setProperty("--cursor-visibility", "visible");
        while (n < text.length) {
            if (text.charAt(n + 1) === "<") isTag = true;
            if (text.charAt(n + 1) === ">") isTag = false;

            if (isTag) {
                n++;
                continue;
            }

            requestAnimationFrame(render);

            if (waitAfter === 0) {
                await nowait();
            } else {
                await wait();
            }

            n++;
        }
        el.style.setProperty("--cursor-visibility", "collapse");
    }

    function parseDelay(d) {
        const parsed = parseInt(d, 5);
        if (isNaN(parsed)) return 0;
        return parsed;
    }

    const titleDelay = parseDelay("20"),
        contentDelay = parseDelay("0");
    const typeeffetct = async () => {
        await typewriter("\u003cspan id=\u0027terminal\u0027\u003e\u003ch1 id=\u0027title\u0027\u003eГри-Гри для JWT\u003c\/h1\u003e\u003cspan id=\u0027date\u0027\u003e2020-05-19 19:33:19 \u002b0300 MSK\u003c\/span\u003e\u003c\/span\u003e", "activity-title", titleDelay);
        await typewriter("Loading... Please wait!", "activity-content", titleDelay);
        
        await typewriter("\u003cspan id=\u0027\u0027\u003e\u003cp\u003e\u003ca href=\u0022https:\/\/dc7495.org\/gris-gris-for-jwt\/\u0022\u003eОригинальная публикация\u003c\/a\u003e\u003c\/p\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eГри-гри\u003c\/strong\u003e — талисман вуду\nили амулет для защиты\nвладельца от зла или на счастье.\u003c\/em\u003e\u003c\/p\u003e\n\u003cp\u003e\u003cstrong\u003eJWT\u003c\/strong\u003e (JSON Web Token) – это токен, а будет этот токен хорошим или плохим, зависит исключительно от вашей реализации. Структура JWT определена в \u003ca href=\u0022https:\/\/tools.ietf.org\/html\/rfc7519\u0022\u003eсоответствующем RFC\u003c\/a\u003e , но если кратко, то JWT состоит из трех частей: заголовка (header), полезной нагрузки (payload) и подписи или данных шифрования. Заголовок и нагрузка представляют собой JSON-объекты “определенной” структуры, а третья часть – это зачастую подпись первой и второй частей. Если верить Википедии, то чаще всего вам придется сталкиваться с тем, что по науке называется JWS\/JWE Compact Serialization, т.е. “компактная” версия токена. От развернутой она отличается тем, что заголовок и нагрузка кодируются в base64url, записываются через точку, после чего получившуюся строку подписывают, тоже кодируют в base64url и дописывают в конец снова через разделитель “точка”. Т.е. на выходе получается что-то вроде:\u003c\/p\u003e\n\u003cp\u003e\u003ccode\u003eeyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NSIsIm5hbWUiOiJKb2huIEdvbGQiLCJhZG1pbiI6dHJ1ZX0K.LIHjWCBORSWMEibq-tnT8ue_deUqZx1K0XxCOXZRrBI\u003c\/code\u003e\u003c\/p\u003e\n\u003cp\u003eТеперь чуть подробнее про каждую из частей, начнем, что называется, с головы. В заголовке указывается необходимая информация для описания самого токена.\u003c\/p\u003e\n\u003cp\u003eОбязательный ключ здесь только один:\u003c\/p\u003e\n\u003cul\u003e\n\u003cli\u003ealg: алгоритм, используемый для подписи\/шифрования (в случае не подписанного JWT используется значение «none»).\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003cp\u003eНеобязательные ключи:\u003c\/p\u003e\n\u003cul\u003e\n\u003cli\u003etyp: тип токена (type). Используется в случае, когда токены смешиваются с другими объектами, имеющими JOSE-заголовки. Должно иметь значение “JWT”.\u003c\/li\u003e\n\u003cli\u003ecty: тип содержимого (content type). Если в токене помимо зарегистрированных служебных ключей есть пользовательские, то данный ключ не должен присутствовать. В противном случае он должен иметь значение “JWT”.\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003cp\u003eВ разделе полезной нагрузки указывается пользовательская информация (например, имя пользователя и уровень его доступа), а также могут быть использованы некоторые служебные ключи. Все они являются необязательными:\u003c\/p\u003e\n\u003cul\u003e\n\u003cli\u003eiss: чувствительная к регистру строка или URI, которая является уникальным идентификатором стороны, генерирующей токен (issuer).\u003c\/li\u003e\n\u003cli\u003esub: чувствительная к регистру строка или URI, которая является уникальным идентификатором стороны, о которой содержится информация в данном токене (subject). Значения с этим ключом должны быть уникальны в контексте стороны, генерирующей JWT.\u003c\/li\u003e\n\u003cli\u003eaud: массив чувствительных к регистру строк или URI, являющийся списком получателей данного токена. Когда принимающая сторона получает JWT с данным ключом, она должна проверить наличие себя в получателях — иначе проигнорировать токен (audience).\u003c\/li\u003e\n\u003cli\u003eexp: время в формате Unix Time, определяющее момент, когда токен станет невалидным (expiration).\u003c\/li\u003e\n\u003cli\u003enbf: в противовес ключу exp, время в формате Unix Time, определяющее момент, когда токен станет валидным (not before).\u003c\/li\u003e\n\u003cli\u003ejti: строка, определяющая уникальный идентификатор данного токена (JWT ID).\u003c\/li\u003e\n\u003cli\u003eiat: время в формате Unix Time, определяющее момент, когда токен был создан. iat и nbf могут не совпадать, например, если токен был создан раньше, чем время, когда он должен стать валидным.\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003ch1 id=\u0022кейсы\u0022\u003eКейсы\u003c\/h1\u003e\n\u003cp\u003eТеперь, когда ты, дорогой читатель, получил базовое представление о том, что такое JWT-токен, я могу перестать копипастить Википедию и заняться разбором проколов, связанных с безопасностью JWT на примере заданий с root-me:\u003c\/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\u0022https:\/\/www.root-me.org\/en\/Challenges\/Web-Server\/JSON-Web-Token-JWT-Introduction\u0022\u003eJSON Web Token (JWT) – Introduction\u003c\/a\u003e\u003c\/li\u003e\n\u003cli\u003e\u003ca href=\u0022https:\/\/www.root-me.org\/en\/Challenges\/Web-Server\/JSON-Web-Token-JWT-Weak-secret\u0022\u003eJSON Web Token (JWT) – Weak secret\u003c\/a\u003e\u003c\/li\u003e\n\u003cli\u003e\u003ca href=\u0022https:\/\/www.root-me.org\/en\/Challenges\/Web-Server\/JSON-Web-Token-JWT-Public-key\u0022\u003eJSON Web Token (JWT) – Public key\u003c\/a\u003e\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003cp\u003eИ сразу ссылки на полезные источники, которые позволят вам избежать дальнейшего чтения моей статьи:\u003c\/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\u0022https:\/\/www.sjoerdlangkemper.nl\/2016\/09\/28\/attacking-jwt-authentication\/\u0022\u003eAttacking JWT authentication\u003c\/a\u003e\u003c\/li\u003e\n\u003cli\u003e\u003ca href=\u0022https:\/\/medium.com\/101-writeups\/hacking-json-web-token-jwt-233fe6c862e6\u0022\u003eHacking JSON Web Token (JWT)\u003c\/a\u003e\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003ch2 id=\u0022introduction\u0022\u003eIntroduction\u003c\/h2\u003e\n\u003cp\u003eВ задании говорится о том, что необходимо авторизоваться под админом, чтобы получить флаг. Точкой входа предстает такая форма:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_1.png\u0022 alt=\u0022форма\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eТак как аккаунта у нас нет, а задание явно направлено на злоупотребление каким-нибудь токеном, попробуем авторизоваться как гость:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_2.png\u0022 alt=\u0022guest\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eИ получаем заветный токен в куке:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_3.png\u0022 alt=\u0022токен\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eХватаем содержимое куки jwt и идем с ним на \u003ca href=\u0022https:\/\/jwt.io\u0022\u003ejwt.io\u003c\/a\u003e , где и лицезреем следующую картину:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_4.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eЧутье бывалого проникновенца говорит нам, что необходимо поменять username с guest на admin и переподписать все это дело. Однако HMAC с использованием SHA-256 требует от нас знания некоего секрета, который создатель задания сообщить нам забыл… Да кому вообще нужна эта подпись, сгенерируем себе токен и без нее:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_5.jpeg\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eЗаменяем значение куки jwt на полученный токен и надеемся, что программист ресурса не такой крутой профессионал, как мы:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_6.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eВы великолепны! Вы не зря зовете себя ковбоем клавиатуры!\u003c\/p\u003e\n\u003ch2 id=\u0022weak-secret\u0022\u003eWeak secret\u003c\/h2\u003e\n\u003cp\u003eПо одному только названию становится понятно, в чем в этот раз будет проблема. Но давайте не будем сильно забегать вперед и для начала поговорим о том, что за “HS256” использовался для подписи сообщения в предыдущем примере. HS256 – это HMAC with SHA-256. Что это значит для нас, простых смертных людей, не обремененных знаниями криптографической магии? Интернет говорит, что HMAC (Hash-based Message Authentication Code) – это код аутентификации сообщения на основе хэширования. Данный вид аутентификации подразумевает наличие у клиента и сервера некоего секретного ключа, который известен только им двоим. Отлично, опытный проникновенец внутри вас наверняка прочитал эту фразу как “это что-то симметричное и его можно сбрутить”. Теперь мы морально готовы приступать к заданию с root-me.\u003c\/p\u003e\n\u003cp\u003eПоехали. Точка входа в задание одаривает нас JSON-ом следующего содержания:\u003c\/p\u003e\n\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\u0022\u003e\u003ccode class=\u0022language-json\u0022 data-lang=\u0022json\u0022\u003e{     \n    \u003cspan style=\u0022color:#f92672\u0022\u003e\u0026#34;message\u0026#34;\u003c\/span\u003e: \u003cspan style=\u0022color:#e6db74\u0022\u003e\u0026#34;Let\u0026#39;s play a small game, I bet you cannot access to my super secret admin section. Make a GET request to \/token and use the token you\u0026#39;ll get to try to access \/admin with a POST request.\u0026#34;\u003c\/span\u003e\n}\n\u003c\/code\u003e\u003c\/pre\u003e\u003c\/div\u003e\u003cp\u003eЯ, конечно, не уверен, но, кажется, нам необходимо сделать GET-запрос на \/token. Оттуда на нас нисходит новый JSON:\u003c\/p\u003e\n\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\u0022\u003e\u003ccode class=\u0022language-json\u0022 data-lang=\u0022json\u0022\u003e{\n    \u003cspan style=\u0022color:#f92672\u0022\u003e\u0026#34;Here is your token\u0026#34;\u003c\/span\u003e: \u003cspan style=\u0022color:#e6db74\u0022\u003e\u0026#34;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJyb2xlIjoiZ3Vlc3QifQ.4kBPNf7Y6BrtP-Y3A-vQXPY9jAh_d0E6L4IUjL65CvmEjgdTZyr2ag-TM-glH6EYKGgO3dBYbhblaPQsbeClcw\u0026#34;\u003c\/span\u003e\n}\n\u003c\/code\u003e\u003c\/pre\u003e\u003c\/div\u003e\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_7.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eПоле role, вероятнее всего, придется сменить с guest на admin, но сразу возникает вопрос валидности подписи. Если же в этом задании вы решите попробовать поменять алгоритм подписи на различные вариации None, то это не сработает. Название челленджа как бы намекает…\u003c\/p\u003e\n\u003cp\u003eНамекает на то, что можно воспользоваться утилитой типа \u003ca href=\u0022https:\/\/github.com\/Sjord\/jwtcrack\u0022\u003ejwtcrack\u003c\/a\u003e  или \u003ca href=\u0022https:\/\/github.com\/magnumripper\/JohnTheRipper\u0022\u003eJohn the Ripper\u003c\/a\u003e  (я так и не понял, как заставить его работать с jwt), которые позволят узнать секрет методом словарного перебора и переподписать себе токен.\u003c\/p\u003e\n\u003cp\u003eЗапускаем jwtcrack:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_8.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eФантастика, мы заполучили секрет и теперь можем переписать себе токен:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_9.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eЕго мы засовываем в заголовок Authorization (почему-то без Bearer) и получаем ключ этой таски. Можно рассказывать теперь историю этого взлома в баре “Джентльмен неудачник”; историю про сожжение Хром вы, конечно, не затмите, но использовать стойкие ключи научите.\u003c\/p\u003e\n\u003ch2 id=\u0022public-key\u0022\u003ePublic key\u003c\/h2\u003e\n\u003cp\u003eВ этот раз без теоретического введения, с места в карьер, так сказать. В челлендже нам дают три endpoint-а api:\u003c\/p\u003e\n\u003col\u003e\n\u003cli\u003e\/key (GET)\u003c\/li\u003e\n\u003cli\u003e\/auth (POST)\u003c\/li\u003e\n\u003cli\u003e\/admin (POST)\u003c\/li\u003e\n\u003c\/ol\u003e\n\u003cp\u003eИ говорят, чтобы мы всех хакнули.\u003c\/p\u003e\n\u003cp\u003eПойдем по порядку и постучим на key:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_10.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eКак и ожидалось, мы получили ключ… Публичный. Сохраняем его себе куда-нибудь и идем дальше. На \/auth нас просят послать свой username в теле запроса. Выполнив требования, получаем:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_11.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eВы уже поняли, да? Идем на jwt.io  и смотрим на то, что мы получили:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_12.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eВидим RS256, и это печалит. Сразу становится понятно, зачем нам дали публичный ключ. RS – это RSA SHA, а RSA (Rivest-Shamir-Adleman) использует асимметричные ключи. Вы, конечно, можете попробовать способы из предыдущих двух заданий, но они тут не сработают. Зато сработает ход, который в обычных условиях показался бы не самым логичным. Давайте попробуем изменить алгоритм подписи с RS256 на HS256, а в качестве секретного ключа использовать полученный нами ранее публичный ключ.\u003c\/p\u003e\n\u003cp\u003eВозникает логичный вопрос, а какого черта это вообще должно сработать? Мы надеемся на то, что код расшифровки токена на сервере выглядит как-то так:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_13.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eИ все это прекрасно работает, если у нас действительно используется асимметричный алгоритм подписи (в нашем случае RSA SHA-256), но если вместо чего-то асимметричного туда попадает что-то симметричное (HMAC SHA-256), то публичный ключ будет обработан функцией как симметричный ключ и токен будет валиден.\u003c\/p\u003e\n\u003cp\u003eДальше придется произвести пляски с бубном, которые бы не пришлось проводить будь версия pyjwt не такой свежей. Связано это с тем, что свежие версии pyjwt не дают использовать публичный ключ в качестве секрета для HS256. Но начнем мы все равно с python:\u003c\/p\u003e\n\u003cp\u003e\u003cimg src=\u0022\/asserts\/images\/gri_14.png\u0022 alt=\u0022\u0022\u003e\u003c\/p\u003e\n\u003cp\u003eОтсюда нам понадобятся заголовок и нагрузка:\u003c\/p\u003e\n\u003cp\u003e\u003ccode\u003eeyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0\u003c\/code\u003e\u003c\/p\u003e\n\u003cp\u003eА вот подписывать эти части нам придется самостоятельно.\u003c\/p\u003e\n\u003cp\u003eПерегоним наш ключ, полученный ранее, в последовательность HEX-ов:\u003c\/p\u003e\n\u003cp\u003e\u003ccode\u003e2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b43415145417576773168347477504a6e5a42772b54327743440a59624832556b4d427852672f686b534d6c365a77693259566d37397771723372506433676a7430695a576432724e42337175644b5749536d42516132517152480a74503666546a6569354d413471734c53586c32724765576a47767471704851446d63583447417841454b7947306e6632445065324170454330323152472f564f0a64595343414149702b536d6443746d35504966314153694f4141585537644c37324959736f63534d6759705249634a755a5341435571314a367775553958796c0a7042314e7657774644334659437a72655435416b5469636276676546316b39792f4f4b5431667632626e5347706a354b4d45462f51575552377877337262516b0a796e6365436a714645744c78584873584a506d5536676a4132494377547131475671435a447a6a6a665162426f4b7a6d59534f774c7a4f6e364a6237454f50670a58514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a\u003c\/code\u003e\u003c\/p\u003e\n\u003cp\u003eА теперь самостоятельно, как взрослые мальчики, подпишем себе токен:\u003c\/p\u003e\n\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003eecho -n \u003cspan style=\u0022color:#e6db74\u0022\u003e\u0026#34;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0\u0026#34;\u003c\/span\u003e | openssl dgst -sha256 -mac HMAC -macopt hexkey: 2d2d2d2d2d424547494e205055424c4943204b45592d2d2d2d2d0a4d494942496a414e42676b71686b6947397730424151454641414f43415138414d49494243674b43415145417576773168347477504a6e5a42772b54327743440a59624832556b4d427852672f686b534d6c365a77693259566d37397771723372506433676a7430695a576432724e42337175644b5749536d42516132517152480a74503666546a6569354d413471734c53586c32724765576a47767471704851446d63583447417841454b7947306e6632445065324170454330323152472f564f0a64595343414149702b536d6443746d35504966314153694f4141585537644c37324959736f63534d6759705249634a755a5341435571314a367775553958796c0a7042314e7657774644334659437a72655435416b5469636276676546316b39792f4f4b5431667632626e5347706a354b4d45462f51575552377877337262516b0a796e6365436a714645744c78584873584a506d5536676a4132494377547131475671435a447a6a6a665162426f4b7a6d59534f774c7a4f6e364a6237454f50670a58514944415141420a2d2d2d2d2d454e44205055424c4943204b45592d2d2d2d2d0a\n\u003c\/code\u003e\u003c\/pre\u003e\u003c\/div\u003e\u003cp\u003eНаша подпись:\u003c\/p\u003e\n\u003cp\u003e\u003ccode\u003ef4a3602e56b0b5d07229d66130ef0aedd1d338cbdc543641d0bb8bedaf8f65ba\u003c\/code\u003e\u003c\/p\u003e\n\u003cp\u003eНо не спешите подставлять ее в наш токен. Вы ведь помните, что подпись должна быть base64url? Кодируем:\u003c\/p\u003e\n\u003cp\u003eНо не спешите подставлять ее в наш токен. Вы ведь помните, что подпись должна быть base64url? Кодируем:\u003c\/p\u003e\n\u003cp\u003eПолучаем:\u003c\/p\u003e\n\u003cp\u003e9KNgLlawtdByKdZhMO8K7dHTOMvcVDZB0LuL7a-PZbo\u003c\/p\u003e\n\u003cp\u003eСобираем токен в кучу:\u003c\/p\u003e\n\u003cp\u003e\u003ccode\u003eeyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.9KNgLlawtdByKdZhMO8K7dHTOMvcVDZB0LuL7a-PZbo\u003c\/code\u003e\u003c\/p\u003e\n\u003cp\u003eЗасовываем в заголовок Authorization: Bearer и хвастаемся еще одним успешным взломом.\u003c\/p\u003e\n\u003c\/span\u003e", "activity-content", contentDelay/100);
        return;
    }

    typeeffetct()
</script>



    </div>
    <style>
    h1 {
         
        color: #23E298;
        line-height: 6vmin;
        font-size: 6vmin;
    }

    
    #block {
        max-height: 200px;
    }
    ul ::marker {
        
        content: "-rw-rw-r--";

    }

    a, strong, ::marker,
    #date {
        color: #D08010;

    }
    table, td{
        border-collapse: collapse;
        border: 2px solid #D08010;
    }
    td{
        padding: 25px;
    }
    li a {
        font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
        font-size: 0.5rem;
        line-height: 1.56;
    }

    li {
        padding-left: 2%;


    }
    a{
        text-decoration: none;
    }
    img{
        max-width: 100%;
    }
    #activity-content {
        font-size: 0.5rem;
        line-height: 1.56;
        overflow-wrap: break-word;
        font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
    }
    #content{
        color:#BBBBBB;
    }
</style>


    
    <span class="navFull">
        
    
    

    
        

<span>
    <a href="/">Home</a>
    <span>&#8192;|&#8192;</span>
    <a href="./..">/articles/</a>
</span>

    

        
        <span class="navCredits">
            Hugo theme created by
            <a href="https://github.com/Yukuro/hugo-theme-shell" target="_blank" rel="noopener">Yukuro</a>
        </span>
</span>


    

    

</body>

</html>