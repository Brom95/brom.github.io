<!DOCTYPE html>
<html lang="ru-ru"><head>
    <title>ПОСТРОЕНИЕ СИСТЕМЫ АГРЕГИРОВАНИЯ ИНФОРМАЦИИ</title>
    <link rel="icon"  type="image/x-icon" href="https://it-irokez.ru/favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="В современном мире, где объемы данных, поступающие в информационные системы, имеют тенденцию к постоянному росту, а отдельное клиентское устройство зачастую не способно совершать выборку и обработку всех необходимых данных режиме реального времени, вопрос построения систем агрегирования информации встает все более остро." />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="ПОСТРОЕНИЕ СИСТЕМЫ АГРЕГИРОВАНИЯ ИНФОРМАЦИИ" />
    <meta property="og:image" content="https://it-irokez.ru/assets/images/logo.jpg" />
    <meta property="og:url" content="https://it-irokez.ru/articles/agregate/" />
    <meta property="og:description" content="В современном мире, где объемы данных, поступающие в информационные системы, имеют тенденцию к постоянному росту, а отдельное клиентское устройство зачастую не способно совершать выборку и обработку всех необходимых данных режиме реального времени, вопрос построения систем агрегирования информации встает все более остро." />
    <style>
@import "https://fonts.googleapis.com/css2?family=Inconsolata&display=swap";:root{--cursor-visibility:hidden}html,body{width:100%;height:100%;overflow:auto;font-family:inconsolata,monospace;font-size:4vmin;line-height:4.1vmin;font-weight:400}body{margin:0;display:flex;flex-direction:row;justify-content:center;align-items:center}#content{min-width:82vmin;min-height:82vmin}::-webkit-scrollbar{width:10px}::-webkit-scrollbar-track{border-radius:10px;box-shadow:inset 0 0 1px white}::-webkit-scrollbar-thumb{border-radius:10px;box-shadow:0 0 0 1px white}.cursor,#activity-title:after,#activity-content:after,#cd:after,#whoami:after,#cat:after,#tree:after{visibility:var(--cursor-visibility);content:"|";overflow:hidden;color:#fff;animation:blink 500ms linear infinite alternate}@keyframes blink{0%{opacity:0}100%{opacity:1}}@media only screen and (min-width:768px){body{font-size:2.5vmin;line-height:2.6vmin}#content{min-width:60vmin}}:root{--cursor-visibility:hidden}body{align-items:unset;overflow-y:scroll}#content{max-width:80vmin}pre{overflow-x:scroll;white-space:pre}@keyframes blink{0%{opacity:0}100%{opacity:1}}















    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
        
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    



body{background:#1b1d1e}body #terminal{color:#BBBBBB}body #user{color:#23E298}body #dir{color:#D08010}body .Typewriter__cursor{color:#BBBBBB}a{color:#BBBBBB}

        

        
        
</style>



    <meta name="yandex-verification" content="355904de153d5134" />
    
    
    <script>window.yaContextCb = window.yaContextCb || []</script>
    <script src="https://yandex.ru/ads/system/context.js" async></script>

    <script type="text/javascript">
            (function (m, e, t, r, i, k, a) {
                m[i] = m[i] || function () { (m[i].a = m[i].a || []).push(arguments) };
                m[i].l = 1 * new Date();
                for (var j = 0; j < document.scripts.length; j++) { if (document.scripts[j].src === r) { return; } }
                k = e.createElement(t), a = e.getElementsByTagName(t)[0], k.async = 1, k.src = r, a.parentNode.insertBefore(k, a)
            })
            (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

        ym(90533415, "init", {
            clickmap: true,
            trackLinks: true,
            accurateTrackBounce: true
        });
    </script>
    <noscript>
        <div><img src="https://mc.yandex.ru/watch/90533415" style="position:absolute; left:-9999px;" alt="" /></div>
    </noscript>
    


</head><body><div id="content">
<div id="block">

<div id="yandex_rtb_R-A-1957258-2"></div>
<script>window.yaContextCb.push(()=>{
  Ya.Context.AdvManager.render({
    renderTo: 'yandex_rtb_R-A-1957258-2',
    blockId: 'R-A-1957258-2'
  })
})</script>
</div>
<meta property="og:title" content="ПОСТРОЕНИЕ СИСТЕМЫ АГРЕГИРОВАНИЯ ИНФОРМАЦИИ"/>


    
    
    



    


    <span id='terminal'><h1 id='title'>ПОСТРОЕНИЕ СИСТЕМЫ АГРЕГИРОВАНИЯ ИНФОРМАЦИИ</h1><span id='date'>Опубликовано: 01-05-2018</span></span>

    <span id=''><p><a href="http://journal.tc22.ru/wp-content/uploads/2018/05/postroenie_sistemi_agregirovaniya_informacii.pdf">Оригинал статьи</a>. Статья была написана в рамках моего обучения в магистратуре.</p>
<hr>
<p>В современном мире, где объемы данных, поступающие в информационные системы, имеют тенденцию к постоянному росту, а отдельное клиентское устройство зачастую не способно совершать выборку и обработку всех необходимых данных режиме реального времени, вопрос построения систем агрегирования информации встает все более остро.</p>
<p>Что же представляет из себя система агрегирования информации в сети Интернет? Согласно [4], система агрегации это способ создания новых web-приложений за счет объединения уже существующих интернетресурсов.</p>
<p>Зачастую, подобного рода системы проектируются как горизонтально масштабируемые системы [1] и служат надстройкой над API некоторых web-сервисов с целью получения больших выборок данных за время меньшее, чем если бы это делалось средствами отдельно взятого устройства [5]. Под масштабируемостью принято понимать способность системы увеличивать свою производительность при добавлении в систему ресурсов.</p>
<p>Различают понятия горизонтальной и вертикальной масштабируемости. Вертикальная масштабируемость – способность системы увеличить общую производительность при увеличении производительности отдельных ее элементов. Горизонтальная масштабируемость – способность системы увеличивать производительность при увеличении количества элементов, участвующих в обработке информации [3].</p>
<p>В данной статье содержатся положения касаемо построения модели взаимодействия компонентов горизонтально масштабируемой системы доступа к удаленным информационным ресурсам в контексте использования данной системы в качестве агрегирующего сервиса. На построенной модели проведено исследование оптимальной конфигурации горизонтально масштабируемого слоя системы. Данный подход позволяет в рамках одной модели отразить как взаимодействие пользователя с данной системой, так и взаимодействие отдельных компонентов системы между собой.</p>
<p>Системы агрегации информации (в западной технической литературе [4,5] устоялся термин «mashupсистемы») строятся на основе горизонтально масштабируемых систем [2]. В рамках архитектуры «клиентсервер» подобная система может соответствовать архитектуре, представленной на рисунке 1.</p>
<p><img src="/assets/images/agregate_1.png" alt="Рис. 1. Архитектура «клиент-сервер» с горизонтально масштабируемым слоем"></p>
<p>Рис. 1. Архитектура «клиент-сервер» с горизонтально масштабируемым слоем</p>
<p>Один из вариантов архитектуры горизонтально масштабированного слоя представлен на изображении (рис.2). Пользователь формирует абстрактный запрос к контролеру горизонтально масштабированного слоя, затем контролер горизонтально масштабируемого слоя обрабатывает запрос, произведя разложение на некоторое количество подзапросов (в случае необходимо), которые могут быть удовлетворены API сервиса и переданы в виде задач другим серверам системы. Связанные с контролером серверы выполняют запрос к удаленному серверу и, получив ответ, передают его контролеру горизонтально масштабируемого слоя, который объединяет ответы, полученные от подчиненных серверов, передает агрегированный результат клиенту.</p>
<p><img src="/assets/images/agregate_2.png" alt="Рис. 2. Архитектура горизонтально масштабируемого слоя"></p>
<p>Рис. 2. Архитектура горизонтально масштабируемого слоя</p>
<p>Для выявления устойчивой к заявленным нагрузкам конфигурации горизонтально масштабируемого слоя в среде имитационного моделирования AnyLogic разработана модель, представленная на рисунке 3. Модель представляет собой набор логических элементов. Элемент source выступает в качестве генератора запросов, delay и delay1 используются для моделирования временной задержки. Сущность resourcePool является хранилищем ресурсов (в данном случае количества потоков), сущность seize хранит заданное количество запросов и при достаточном количестве ресурсов, передает запрос далее.</p>
<p>В случае невозможности обработки запроса, запрос уничтожается в сущности sink. Сущность sink1 также используется для уничтожения запросов, по завершению работы цикла.</p>
<p>Для моделирования предложена ситуация, когда горизонтально масштабируемый слой используется в качестве сервиса, а интенсивность запросов, заложенная в source, составляет случайное значение согласно треугольному распределению [6] от 1 до 20 с наиболее вероятным значением, составляющим 5 запросов в минуту.</p>
<p>Моделирование включает три этапа:</p>
<ol>
<li>Моделирование работы контроллера и удаленного сервера. В рамках этапа моделируется обработка 3 запроса контроллером и удаленным сервером, работа контроллера по разделению первичного запроса. Время на обработку запроса контролером (delay1) и удаленным сервером (delay) заложено как случайное значение согласно треугольному распределению от 0.5 до 5 с наиболее вероятным значением 1 секунда на обработку одного запроса. Блок split используется для моделирования работы контролера по разделению первичного запроса к горизонтально масштабируемому слою на запросы, которые необходимо совершить к API удаленного сервиса. После разделения, оригинальный запрос перемещается в sink.</li>
</ol>
<p><img src="/assets/images/agregate_3.png" alt="Рис. 3. Модель горизонтально масштабируемого слоя как сервиса"></p>
<p>Рис. 3. Модель горизонтально масштабируемого слоя как сервиса</p>
<ol start="2">
<li>
<p>Моделирование работы горизонтально масштабированного слоя. Работа серверов горизонтально
масштабируемого слоя, которым контролер ставит в соответствие задачи, реализуется блоками resourcePool, release и seize. Элемент resourcePool представляет собой набор потоков, доступных в горизонтально масштабируемом слое для запроса к API удаленного сервера и рассчитывается как Servers*10, где Servers это количество серверов в горизонтально масштабируемом слое используемых для решения задач, полученных от контроллера. Каждый сервер обладает потенциалом обработки 10 одновременных потоков, поэтому размер очереди блока seize рассчитывается аналогично.</p>
</li>
<li>
<p>Моделирование потоков. Освобождение потоков происходит после получения ответа от удаленного сервера. Возвращение ресурсов (свободных потоков) в resourcePool моделируется блоком release. Если блок seize не может обработать поступивший запрос или поместить его в очередь, то запрос поступает в sink2.</p>
</li>
</ol>
<p>Для данной модели, приняты следующие допущения: оптимальным количеством серверов считается такое количество серверов в горизонтально масштабируемом слое, при котором не один из запросов, назначенных контроллером горизонтально масштабируемого слоя, не будет отклонен. Также, в рамках модели, все серверы в горизонтально масштабируемом слое считаются одинаково сконфигурированными и имеющими десять потоков.</p>
<p>В результате моделирования получена таблица, которая содержит значения оптимального количества серверов в горизонтально масштабируемом слое:</p>
<table>
<thead>
<tr>
<th style="text-align:center">Коэффициент деления первичного запроса</th>
<th style="text-align:center">Оптимальное количество серверов в горизонтально масштабируемом слое</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">2</td>
</tr>
<tr>
<td style="text-align:center">50</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center">100</td>
<td style="text-align:center">20</td>
</tr>
<tr>
<td style="text-align:center">500</td>
<td style="text-align:center">87</td>
</tr>
<tr>
<td style="text-align:center">100</td>
<td style="text-align:center">149</td>
</tr>
</tbody>
</table>
<p>Как можно видеть из таблицы, оптимальное количество серверов в горизонтально масштабируемом слое нелинейно зависит от коэффициента изначального запроса. Проведем интерполяцию степенным многочленом. Известно, что через <code>n+1</code> точек на плоскости можно провести кривую, являющуюся графиком степенного многочлена (полинома) степени n, причем такой полином единственный. Воспользуемся следующей формулой:</p>
<p>$L(x) =\sum_{i=0}^{n} y_il_i(x)$</p>
<p>$l_i(x) = \prod_{{j=0},{j\neq i}}^{n} {(x-x_j) \over x_i-x_j}$</p>
<p>За $x_i$ примем коэффициент деления первичного запроса, за $y_i$ – оптимальное количество серверов в горизонтально масштабируемом слое при заданной величине коэффициента деления первичного запроса.</p>
<p>Подставив значения в формулы получаем следующую зависимость:
$f(x) = 1.76571 *  10^{-8}x^3 - 0.0000767385x^2 + 0.208204x − 0.122419 $, где $x$ это количество запросов, на которые будет разделен первичный запрос, а $f(x)$ - количество серверов, которое потребуется, чтобы все запросы были обработаны. Убедимся в корректности полученной для модели формулы на точках, не участвовавших в выявлении зависимости. Так, при разделении первичного запроса на 25 подзапросов получаем:</p>
<p>$ 1.76571 * 10^{−8}x^3 − 0.0000767385x^2 + 0.208204x − 0.122419 ≈ 5.035$</p>
<p>Проведя моделирование при наличии пяти серверов, получающих задания от контролера горизонтально масштабированного слоя, убеждаемся в том, что модель работает корректно и все запросы были обработаны. При расщеплении изначального запроса на 127 запросов получаем:</p>
<p>$1.76571 * 10^{−8}x^3 − 0.0000767385x^2 + 0.208204x − 0.122419 ≈ 25.1179. $
Проведя моделирование на двадцати пяти серверах, получающих задания от контролера горизонтально масштабированного слоя, убеждаемся в том, что модель работает корректно и все запросы были обработаны.</p>
<p>Таким образом, в работе построена аппроксимирующая функция для системы агрегирования информации и математическая зависимость коэффициента деления первоначального запроса и количества серверов в горизонтально масштабируемом слое, необходимого для их обработки. Использование данной модели и математической зависимости позволит оценить устойчивость подобных систем к заявленным нагрузкам до непосредственного введения их в эксплуатацию.</p>
<p>Список литературы</p>
<hr>
<ol>
<li>Косяков М.С. Введение в распределенные вычисления / Учебное пособие. – Санкт-Петербург: НИУ ИТМО, 2014. - 155 с.</li>
<li>Радченко Г.И. Распределенные вычислительные системы / Г.И. Радченко. – Челябинск:Фотохудожник, 2012. – 184 с.</li>
<li>Шамакина А. В. Обзор технологий распределенных вычислений // Вестник ЮУрГУ. Серия: Вычислительная математика и информатика. 2014. №3 С.51-85.</li>
<li>Baker M., Buyya R., Laforenza D. Grids and Grid Technologies for Wide–area Distributed Computing // Journal of Software-Practice &amp; Experience. 2002. Vol. 32, No. 15. P. 1437–1466</li>
<li>Benslimane D., Dustdar S., Sheth A. Services Mashups: The New Generation of Web Applications // IEEE Internet Computing. 2008. Vol. 12. doi: 10.1109/MIC.2008.110</li>
<li>Help - AnyLogic Simulation Software [Электронный ресурс] / triangular. – <a href="https://help.anylogic.ru/index.jsp?topic=%2Fcom.anylogic.help%2Fhtml%2Ffunctions%2Ftriangular.html">https://help.anylogic.ru/index.jsp?topic=%2Fcom.anylogic.help%2Fhtml%2Ffunctions%2Ftriangular.html</a> (дата обращения: 20.12.2017)</li>
</ol>
</span>



    </div>
    <style>
    h1 {
         
        color: #23E298;
        line-height: 6vmin;
        font-size: 6vmin;
    }


    #block {
        max-height: 350px;
        max-width: 1000px;
    }

    ul ::marker {

        content: "\1F480";

    }

    a,
    strong,
    ::marker,
    #date {
        color: #D08010;

    }

    table,
    td {
        border-collapse: collapse;
        border: 2px solid #D08010;
        max-width: 100%;
    }

    td {
        padding: 25px;
    }

    li a {
        font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
        font-size: 1em;
        line-height: 1.56;
    }

    li {
        padding-left: 2%;


    }

    a {
        text-decoration: none;
        font-size: 1em;
    }

    img {
        max-width: 100%;
        max-height: 80vh;
    }

    .navFull {
        background-color: #353535;
        line-height: 150%;
        font-family: "Courier New";
         
        display: inline;
        position: fixed;
        bottom: 0px;
        left: 0px;
        display: flex;
        flex-direction: row;
        justify-content: space-around;
        width: 100%;
        align-items: baseline;
        padding-top: 5px;
        padding: 10px;
        padding-bottom: 0px;
    }

     
    .navCredits {
        float: right;
        padding-right: 18px;
        padding-bottom: 10px;
         
    }

    #navigationBlock {}

    #content::after {
        content: "\a\a";
        white-space: pre;
    }

    
    #content {
        font-size: 2.0vmax;
        line-height: 1.56;
        overflow-wrap: break-word;
        font-family: -apple-system, BlinkMacSystemFont, Arial, sans-serif;
        color: #BBBBBB;
    }
    @media only screen and (min-width : 1400px) {
        #content {
            font-size: 2.0vmin;
        }

    }
    li p {
        padding-left: 5%;
    }

    #coffee {
        background-color: #D08010;
        color: #fff;
        display: block;
        padding: 10px;
        border-width: 2px;
        border-radius: 10px;
    }

    @media only screen and (max-width:500px) {
        #content {
            padding-left: 2%;
        }

        body {
            font-size: 1.2em;
        }

        .navFull {
            line-height: 100%;
        }
    }
</style>

    
    <span class="navFull">
        
    
    

    
        

<div id="navigationBlock">
    <a href="/">Home</a>
    <span>&#8192;|&#8192;</span>
    <a href="./..">/articles/</a>
</div>

    

        
        <div class="navCredits">
            <a id="coffee" href="https://www.tinkoff.ru/cf/qTUdfLwVFO">Купить автору кофе</a>
        </div>
</span>


    

    

</body>

</html>